## 라우트 중복 제거하기
express는 라우터와 미들웨어의 중복이어서 코드가 복잡해질수있다.

```js
// 앱라우터메소드로 중복된 라우트를 제거할수있다.
app.route('products');
	.get((req,res) => {
		res.json...
	})
	.post((req,res) => {
		res.json...	
	})
	
app.route('/products/:id');
	.patch((req,res) => {
		res.json...
	})
	.delete((req,res) => {
		res.json...
	})
//app.post('/products', ...)
//app.patch('/products/:id', ...)
```
> 코드도 간략해지고
> 중복된 코드도 묶이므로 편해진다.

## 라우터 만들기
여전히 큰 객체에 하나의 파일에 작성하는것은 똑같다
```js
// 라우트안에 작은 라우트라고 불릴만큼
// 코드 작성법이 비슷하다
const productRouter = express.Router();

productRouter.route('/');
	.get((req,res) => {
		res.json...
	})
	.post((req,res) => {
		res.json...	
	})
	
productRouter.route('/:id');
	.patch((req,res) => {
		res.json...
	})
	.delete((req,res) => {
		res.json...
	})	

// app메소드를 연결하여 라우터연결
//app.use(productRouter);
// 여기서 한번더 중복을 제거할수있다
app.use('/products',productRouter);
```
> 이렇게 작성된 라우터파일은 하나의 파일이아니라 다른곳에서 연결하여 분류할수있다.

## 라우터 레벨 미들웨어
특정 레벨에서 미들웨어를 적용할수있다는의미 이것을 라우터 레벨 미들웨어라고 한다.
```js
productRouter.use((req,res,next) => {
	console.log('Product Router에서 항상 실행!')
	next();
});

// 어떠한 경로로 요청을 보내도 해당 콘솔이 출력이된다.

const userRouter = express.Router();

// ...

app.use('/products', productRouter);
app.use('/users', userRouter);
```
> 문장을 출력해보면 각각 개별로 나오는것을 확인할수있다.
> 이러한것을 라우터 레벨 미들웨어
> - 로그인 한 사용자만 api를 사용할수있도록 하거나
> - 특정 api는 관리자만 사용가능하게 만드는것처럼
> - 다른 설정에 필요할때 많이 활용된다.