## Redis를 문서 데이터베이스로 사용하는 방법 이해
1. create a seconary index 보조 인덱스 만들기
2. add JSON documents JSON문서 추가
3. search and query your data 데이터 검색 및 쿼리

다음 구조의 예지를 사용 간단한 자전거 인벤토리를 참조
```json
{
  "brand": "brand name",
  "condition": "new | used | refurbished",
  "description": "description",
  "model": "model",
  "price": 0
}
```

---
## 연결 하고 나서 인덱스 만들기
키스페이스를 스캔하는 방법을 배웠다.
FT.CREATE일부 텍스트 필드, 숫자 필드 및 태그 필드(조건)가 있는 인덱스를 만드는 명령이다.
텍스트 필드의 가중치는 1.0이며, 이는 전체 텍스트 검색의 컨텍스트에서 동일한 관련성을 갖는다는것을 의미한다. 필드 이름은 JSONPath 개념을 따른다.
```redis-cli$
> FT.CREATE idx:bicycle ON JSON PREFI 1 bicycle: SCORE 1.0 SCHEMA $.brand AS brand TEXT WEIGHT 1.0 $.model AS model TEXT WEIGTH 1.0 $.description as description TEXT WEIGHT 1.0 $.price AS price NUMERIC $.condition AS condition TAG SEPARATOR ,
```
> 보기 쉽게 한다면
```node.js
const schema = {
  '$.brand': {
    type: SCHEMA_FIELD_TYPE.TEXT,
    SORTABLE: true,
    AS: 'brand'
  },
  '$.model': {
    type: SCHEMA_FIELD_TYPE.TEXT,
    AS: 'model'
  },
  '$.description': {
    type: SCHEMA_FIELD_TYPE.TEXT,
    AS: 'description'
  },
  '$.price': {
    type: SCHEMA_FIELD_TYPE.NUMERIC,
    AS: 'price'
  },
  '$.condition': {
    type: SCHEMA_FIELD_TYPE.TAG,
    AS: 'condition'
  }
};

try {
  await client.ft.create('idx:bicycle', schema, {
    ON: 'JSON',
    PREFIX: 'bicycle:'
  });
} catch (e) {
  if (e.message === 'Index already exists') {
    console.log('Index exists already, skipped creation.');
  } else {
    // Something went wrong, perhaps RediSearch isn't installed...
    console.error(e);
    process.exit(1);
  }
}
```

## JSON 문서 추가
SET명령을 사용하여 새 JSON 문서를 만듬
```redis-cli
JSON.SET "bicycle:0" "." "{\"brand\": \"Velorim\", \"model\": \"Jigger\", \"price\": 270, \"description\": \"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids\\u2019 pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go.\", \"condition\": \"new\"}"
```
> 인덱스를 만들고 이제 JSON문서를 추가했다면 search by values of keys를 사용해서 데이터를 검색해볼수있다.

```JSON
{

brand

:

"Velorim"

model

:

"Jigger"

price

:

270

description

:

"Small and powerful, the Jigger is the best ride for the smallest of tikes! This is the tiniest kids’ pedal bike on the market available without a coaster brake, the Jigger is the vehicle of choice for the rare tenacious little rider raring to go."

condition

:

"new"

}
```