## 논리적 외래키, 물리적 주키
주문 테이블  - 배송 테이블,
회원 테이블 -  댓글 테이블,
부서 테이블 - 직원 테이블 등

많은 테이블이 외래키로 관계를 맺고 있고, 여러 테이블들을 하나로 합치는 조인을 이 외래키기준으로 하는것이 일반적이다.
근데 실무에서 데이터베이스의 테이블을 살펴보다보면

**어떤 테이블의 특정 컬럼이 외래키로  설정되어야 할 것 같은데**
**외래키로 설정되지 않은 경우**가 있다.

논리적으로 다른 테이블의 컬럼을 참조해야되서 개념상 외래키가 되는것과
실제로 해당 컬럼을 외래키로 설정해서 두 테이블 간 참조 무결성을 지킬 수 있게 되는 것은 별개의 개념
DBMS상에서 실제로 특정 컬럼을 외래키로 설정해서 두 테이블 간의 참조 무결성을 보장할 수 있게 됐을때,  그컬럼을 물리적 외래키라고 한다.

1. 성능문제
	1. 물리적 외래키가 있는 자식 테이블의 경우 INSERT,  UPDATE문 등이 실행될 때 약간의 속도 저하가 발생할 가능성이 있다. 참조 무결성을 혹시 깨뜨리는 변화가 발생하지는 않을지 추가적으로 검증해줘야하기 때문
	2. 즉 성능을  좀 양보해줘야한다. 일단 당장 빠른 성능이 중요할시 물리적 외래키를 굳이 설정하지 않기도 한다. 나중에 참조 무결성을 어기는 데이터들은 정기적으로 별도 확인 후에 삭제해주는 방식을  택하기도 한다.
2. 레거시 데이터의 참조 무결성이 이미 깨진 상태라면?
	1. 그동안 물리적 Foreign Key 없이 데이터를 쌓아와서 참조 무결성을 어기는 row들이 생겨버린 상황이라고 해봅시다. 어떻게 할까? 일단 참조 무결성을 어기는 row들을 과감하게 지워버린 후에 물리적 Foreign Key를 설정하는 방법이 있을 겁니다. 하지만 만약 참조 무결성을 어기는 row들의 수가 많고, 그것들도 소중한 데이터라서 함부로 삭제할 수 없는 상황이라면 어떻게 해야할까요?
	2. 이미  레거시 데이터때문에 전체적인 차원에서의 참조 무결성은 깨져버린 상태이다. 바로 이런 현실적인 이유 때문에 그냥 물리적 외래키없이 참조 무결성을 지키는 것을  포기하고 서비스를 운영하는 곳이 생긴다.  일단 소중한 데이터들은 삭제하지는 말자는 생각
	3. 이러한  이유들로 굳이 논리적 외래키를  물리적 외래키로  설정하는  않는 경우가 많다.
	4. 다만 은행,학적 관리 서비스 등 에서는 논리적 외래키를 반드시 물리적 외래키로 설정해야한다. 100% 정확성이 요구되는곳에 참조 무결성이 깨진다면, 최악의 상황을 만나게 되기 때문
## 외래키를 삭제하는 방법
SHOW CREATE TABLE review;
테이블에 ``에 적힌 외래키 제약사항을 확인하여 외래키이름을 확인
그리고  삭제할려면
```sql
-- 밑에 코드처럼 삭제하면된다.
-- 컬럼처럼 DROP이라는 것을 사용하여 외래키를 삭제할수있다.
ALTER TABLE review
	DROP FOREIGN KEY fk_review_table;
```

## 데이터베이스의  설계사항,스키마
**데이터베이스에 관한 모든 설계사항을**  스키마(Schema)라고 한다.
처음 구축할때 스키마를 짜는데 짜는것을 '데이터베이스 모델링'또는 '데이터베이스 디자인'이라고 한다.  데이터베이스 첫 설계가  향후 환경 변화에 맞춰 데이터베이스를 수정할 때 얼마나 더 유연하고 편하게 할수있는지에 큰 영향을 미치게된다.
즉, 처음 부터 스키마를 잘 짜는게 중요하죠

1. 개념적 스키마(Conceptual  Schema),  위의 개념이 개념적 스키마에 해당, 단하나의 조직, 하나의 기관, 하나의  서비스 등에서 필요하는 데이터베이스 설계사항을 의미,  보통 스키마라고 하면 이 개념적 스키마를 의미
2. 물리적 스키마(Physical Schema), 실제 컴퓨터 저장이에 어떤 방식으로 저장할지를 결정하는 스키마이다. 물리적 스키마는 저장 스키마(Storage Schema), 내부 스키마 (Internal Schema)라고도 한다.
물리적 스키마는 일반 개발자나, 사용자가 다룰 일이 없다. DBMS를 만드는 개발자들이 다루는 개념이다. 똑같은 개념적 , 같은 데이터라도 실제로 어떻게 저장할지는 DBMS에 따라 다르니, 각 DBMS만의 장단점, 특성들이 드러나게 된다.

여러 스키마에서는 단어가 오용되는데 '데이터베이스 설계사항'으로 이해하면된다. 혹시라도 다른 의미로 사용되는 것 같은 경우 특정 DBMS에서만 가지는 의미가 아닐지 한번 찾아보자.

## 외래키로 빠르게 파악하는 테이블 간의 관계
![[Pasted image 20250928003407.png]]
1. course_id컬럼 -> course테이블의 id컬럼
2. undergraduate_id컬럼 -> undergraduate 테이블의 id 컬럼
물리적 외래키로 설정하면 '강의평가 데이터베이스'의 기본적인 틀을  짤수있다.
- 어느 수업에 대해서
- 대학생 누구로 부터
- 각 강의평가들이 어디서 달린지 알수있고, 각 참조 관계마다 테이블 간의 '참조 무결성'을 보장할수있게된다.

professor(교수 정보)라는 테이블을 추가한다면?
![[Pasted image 20250928003638.png]]
이런 식으로 테이블이 추가될수록, 기존  테이블의 구조가 변형되고, 외래키 수도  늘어나게된다.
이말 을  거꾸로 한다면
각 외래키에  무슨 테이블에 있고 (FROM) 어느 테이블의 어느 컬럼을 참조하는지(REFERENCE TO)를 파악하면 테이블 간의 관계, 나아가 데이터 저장 현황을 빠르게 파악할 수 있다는 뜻이다.

논리적 외래키가  존재한다면 해당데이터베이스의 스키마에 관한문서, 도면, 파일등을  참고하는게 좋다.
논리적 외래키는 스키마를 짜는 데이터베이스 모델링 단계에서 모두 고려되기 때문이다.
이미 운영 중인  데이터베이스를 맡게된다면 이런 외래키들을 빨리 파악하는 것이 중요하다.