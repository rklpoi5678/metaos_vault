## 네트워크 1
컨테이너에서 서버를 만들면 클라이언트에서 접속할수없다. 왜냐하면 네트워크도 격리의 대상이다. 그래서 외부에서 접근이 불가능하다. 다행이 docker network기능으로 통신할수있다.

유의점
도커가 제공하는 이 네트워크기술은 표준이 아닙니다. 그래서 도커환경에서만 사용가능하다. 최근 쿠버네티스나  포드맨처럼 컨테이너 기술 표준이 다양해지고있다.

통신하는법
1. 같은 컨테이너끼리 통신하는법
2. 호스트 네트워크에서 통신하는법

같은 컨테이너끼리 통신하는법
**docker network ls**
docker에서 기본으로 제공하는  네트워크 드라이브를 제공한다.

```docker
# network create
docker network create my-first-network

# network remove
docker network rm my-first-network

## 다만 미리정의된 3가지기본 네트워크는 삭제할수없다.

docker container ls
docker network create mbti-network
docker network ls

## docker conatiner run start
docker container  run \
--name mbti \
-e PORT=3000 \
--rm \
-d  \
--network  mbti-network \
metaoos/mbti:embedded-db

## 실행시킨 컨테이너 정보는 inspect명령어로 확인가능
docker container inspect
### 참고 도커 요소를 다루는 상세정보를 다루는 명령어로 자주사용됨

## 네트워크 기본적으로 생성된것을 확인할수있다.
"Network":  {
...
	"DNSNAME":  {
		"mbti",
		"3d94f26f164b"
	}
}
```

다른 컨테이너에서 통신이 잘되나 확인
```docker
docker container run \
--rm \
curlimages/curl  \
curl mbti:3000/api/healtcheck

## 같은 네트워크에  통신이 되지않아  연결되지않는것이 정상

## 이제 같은 네트워크에서 통신
## 즉, 같은 네트워크로 묶인 컨테이너는  같은 IP주소  DNS로 접속이 가능하다는 사실
## 기본 네트워크는 bridge로 되고 dnsname:null이 된다.
docker container run \
-rm \
--network mbti-network \
curlimgaes/curl \
curl mbti:3000/api/healthcheck
```

## 네트워크 2
컨테이너 포트를 외부로  나오게하고  다른 호스트에서 해당 포트를 짝지어놓는것을 
포트매핑/포트 바인딩 (Port Mapping/Port Binding)이라고한다.
```docker
docker container run \
--name  mbti \
-e PORT=3000 \
--rm \
-d \
-p 4000:3000  \
metaoos/mbti:embedded-db
```
![[Pasted image 20250928214644.png]]
> 우리의 4000번 포트가 3000번포트로 바운딩이 되었다.
```docker
"HostConifg":  {
	...
	"PortBindings"  : {
		...
		"3000/tcp"	: [
			{
				"HostIp": "",	
				"HostPort": "4000"
			}	
		]
	}
},

## 이렇게 되먼 호스트에 4000포트로  컨테이너 3000번에 접속하면 되겠지요
localhost:4000/api/healthcheck
### 이렇게  바인딩을 시키면 같은 네트워크 컨테이너에 묶이지않은 다른 컨테이너도 통신이 가능하게 할수있다.

docker network create other-network

docker container run \
--rm \
--network other-network \
curlimages/curl \
curl  host.docker.internal:4000/api/helthcheck
```

```Dockerfile
EXPOSE 3000 # 퍼블리셔 옵션과 차이는 실제로 외부로 포트가 노출되는것에 대한 차이가있다.
# EXPOSE 는 실제로 공개하지 않습니다.
# 도커의  네트워크 기술은 표준기술이  아니기에 어떤 플랫폼에서는 노출하는 방법이 다르다는것이다. 도커파일에 공개해야한다! 라고 적는것이 최선이라는것이다. 
# 컨테이너 정보는 어떤 컨테이너와도 호환되는 표준이다. 그래서 도커파일에 이러한 내용을 적어서 보내준다는것이다.
```

```docker
docker container run \
--name mbti \
-e PORT=3000 \
--rm \
-d \
--expose 3000 \
metaoos/mbti:embedded-db

docker container inspect

"Config": {
	"ExposedPorts": {
		"3000/tcp": {}	
	}
}
## 다만 그렇게 공개되어야한다는 정보이니 실제로 접속하면 접속이 안될것이다.
## EXPOSE는 컨테이너에 이렇게 공개되어야한다고 알려주는 정보역할이니
```

```실습문제
#3000번 포트를 호스트의 3003번 포트로 바인딩하여 공개하는 컨테이너 실행
docker cotainer run \
--name mbti \
-- rm \
-e PORT=3000 \
-p 3003:3000 \
metaoos/mbti:embedded-db
```