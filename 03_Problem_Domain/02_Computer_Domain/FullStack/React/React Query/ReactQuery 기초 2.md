## 캐싱 이해하기
유저가 보는 데이터를  어디다 저장해 두었다가 백엔드에 요청할 필요없이 바로 보여주면 좋겠다. 바롤 이럴때 캐시(cache)라는 걸 사용합니다.

### **캐시(Cache)**
데이터를 복사해 놓는 임시 장소를 말한다. 보통 저장 공간의 크기는 작지만, 데이터 가져오는 속도가 빠르다는 특징이있다.
기본적으로 웹 브라우저는 캐시를 사용해서 속도를 높이고 네트워크 비용을 아낀다.

### **React Query의 캐시**
 캐시에 저장되어있는 유저에게 보여주기도 하는것이다.
 ```js
 function HomePage() {
	const result = useQuery({ queryKey: ['posts'], queryFn: getPosts }) 
	console.log(result);
	
	...
 }
 ```
 > 무조건 useQuery를 사용한다고 무조건 쿼리 함수가  실행되어 백엔드로부터 데이터를 받아오는 것은 아니다. reacequerydevtools 에 보면 `['posts']`라는 쿼리 키로 우리가 받아 온 포스트 데이터가 캐시에 저장되어있다.

먼저 전달받은 쿼리키로 캐시에  저장된 데이터가 있는지 체크합니다.
없다면 쿼리 함수를 실행해 데이터를 백엔드로부터 받아오게 되고, 그런 다음에 쿼리 키, 여기서는 'posts'라는  키로 데이터를 캐시에 저장합니다.

만약 있다면 이떄는 데이터의 상태에  따라 조금 다르게 동작한다.
이제 막 데이터를 받아와서 캐시에 저장되었다면 `fresh` 신선한 상태로 판단한다.
그러다가  stale time이라고  불리는 특정 시간이 지나면 데이터는 `stale` 신선하지 않은 상태가된다.
마지막으로 (DOM트리에서 제거) 해당 데이터가 쓰이지 않는 상태가 되어서 데이터는 inactive 상태가 된다.

신선한 상태면 : 캐시에 저장된 데이터를  리턴하고 끝
안신선 상태면: 데이터가 백그라운드에서  refetch를  진행, 벡엔드에서 새로 받아온데이터로 기존 키에 데이터를 갱신
다음 4가지 상황에서 refetch 진행 
1. 쿼리 인스턴스  마운트
2. 브라우저 창에 재포커스
3. 네트워크가 재연결
4. 미리 설정해둔 refetch interval시간이 지났을때
5. 각각  `refetchOnMount, refetchOnWindowFocus, refetchOnReconnect, refetchInteval`

### **Stale  Time**
디폴트 값으로 stale time이 0으로 설정되어 있다.