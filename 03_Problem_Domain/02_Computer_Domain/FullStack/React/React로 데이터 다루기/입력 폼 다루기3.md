## 별점 컴포넌트 만들기

```jsx
import './Rating.css'

const RATINGS =  [1,2,3,4,5];

function Star({ selected: true }) {
	const className = `Rating-star ${selected ? 'selected' : ''}`;
	return <span className={className}>*</span>
}

function Rating({ value = 0 }) {
	return (
		<div>
			{RATINGS.map((rating) => (
				<Star key={rating} selected={value >= rating} />	
			))}	
		</div>	
	);
}

export default Rating;
```

## 나만의 별점 인풋 만들기
```jsx
import './Rating.css'

const RATINGS =  [1,2,3,4,5];

function Star({ selected = false, rating, onSelect, onHover }) {
	const className = `Rating-star ${selected ? 'selected' : ''}`;
	
	const handleClick = onSelect ? () => onSelect(rating) : undefined;
	const handleMouseOver = onHover ? () => onHover(rating) : undefined;
	return <span
			 className={className}
			 onClick={handleClick}
			 onMouseOver={handleMouseOver}
			 >
			 *
			 </span>
}

function Rating({ value = 0, onSelect, onHover, onMouseOut }) {
	return (
		<div onMouseOut={onMouseOut}>
			{RATINGS.map((rating) => (
				<Star 
					key={rating}
					selected={value >= rating}
					rating={rating}					
					onSelect={onSelect}
					onHover={onHover}
				 />	
			))}	
		</div>	
	);
}

export default Rating;
```
```jsx
//RatingInput.js
import { useState } rom 'react';
import Rating from './Rating';
import './RatingInput.css';

function RatingInput({  name, value, onChange }) {
	const [rating, setRating] = useState(value);
	
	const handleSelect = (nextValue) => onChange(name, nextValue);
	
	const handleMouseOut = () => setRating(value);
	
	return <Rating
			 className="RatingInput"
			 value={rating}
			 onSelect={handleSelect}
			 onHover={setRating}
			 onMouseOut={handleMouseOut} />
}

export default RatingInput;

//Rating.js

function Rating ({ className, value=0,...})
return (
	<div className={className} onMouseOut={onMouseOut}>
)

// 이제 input으로 하드코딩한곳을 RatingInput.js 컴포넌트로  교체해주면 된다. 
```

## 글 작성하기
FromData: 우리가 사용할 api에서는 파일업로드를 편하게 할려고 폼데이터를  사용하기때문에 사용한다.
```jsx
// api.js
const BASE_URL = 'https://codeit.kr/api';

export async function getReiviews({
	order: 'createdAt',
	offset = 0,
	limit = 6,
}) {
	const query = `order=${order}&offset=${offset}&limit=${limit}`;
	const response = await fetch(
		`${BASE_URL}/film-review?${query}`)'
	if(!response.ok) {
		throw new Error('리뷰를 불러오는데 실패했습니다.');	
	}
	const body = await response.json();
	return body;
	);
}
	

export async function creatReiviews(formData) {
	const response = fetch(`${BASE_URL}`, {
		method: 'POST',	
		body: formData
	})
	if(!response.ok) {
		throw new Error('리뷰를 실패했습니다.');	
	}
	const body = await response.json();
	return body;
	);
}
```
```jsx
//ReviewForm.js
const INITAL_VALUES = {
	title: '',
	rating:  0,
	content: '',
	imgFile: null,
};
//에러랑 로딩 처리
const [isSubmitting, setIsSubmitting] = useState(false);
const [submittingError, setSubmittingError] = useState(false);
const [value, setValue] = useState(INITAL_VALUES);

const handleFormSubmit = async(e) => {
	e.preventDefault();
	const formData = new FormData(); 
	formData.append('title', values.title);
	formData.append('rating', values.rating);
	formData.append('content', values.content);
	formData.append('imgFile', values.imgFile);
	try {
		setSubmmitError(null);
		setSubmmitting(true);
		await creatReviews(formData);
	} catch (error) {
		setSubmmittingError(error);
		return;	
	} finally {
		setSubmitting(false);
	}
	setValue(INITAL_VALUES);
	
	return (
		//...
		
		<button type="submit" disabled={handleFormSubmit}>확인</button>	
		{submittingError?.message && <div>{submittingError.message}</div>}
	)
});
```

## 리스폰스 데이터 반영하기
```jsx
// createReveiw에서 받아온  리스폰스 데이터를 변수에 할당
let result;
//,,,
	const result = await createReview(formData);
	
//...
// revies를 onSubmitSuccess에 넣어준다.
const { review } = result;
onSubmitSuccess(review);
```
```jsx
// app컴포넌트
const handleSubmitSuccess = (review) => {
// 삭제될때 동기화가 안되었던 오류 때문에 콜백을 사용합니다.
	setItems((prevItems) => [review, ...prevItems]);	
}

return (
// 핸들러를 retivewForm에 내려줍니다
	<ReviewForm onSubmitSuccess={handleSubmitSuccess} />
)
```